# Query for finding the top ten customer who spent the most money in the store.

SELECT Customer.CustomerId,sum(Invoice.Total) best

FROM Invoice

JOIN Customer

On Invoice.CustomerId = Customer.CustomerId

GROUP BY Customer.CustomerId

ORDER BY best DESC

LIMIT 10

# Query for top ten music artists by number of rock songs

SELECT count(*) Songs,Artist.ArtistId,Artist.Name

FROM Artist

JOIN Album

On Artist.ArtistId = Album.ArtistId

JOIN Track

On Album.AlbumId = Track.AlbumId

JOIN Genre

On Track.GenreId = Genre.GenreId

WHERE Genre.Name = 'Rock'

Group BY Artist.Name

ORDER BY Songs DESC

LIMIT 10

#Query for top ten most earning artists


SELECT Artist.Name,SUM(InvoiceLine.UnitPrice*InvoiceLine.Quantity) Amount

FROM Artist

JOIN Album

On Artist.ArtistId = Album.ArtistId

JOIN Track

On Album.AlbumId = Track.AlbumId

JOIN InvoiceLine

On Track.TrackId = InvoiceLine.TrackId

GROUP BY Artist.Name

ORDER BY Amount DESC

LIMIT 10

#Query for top ten purchasers for the most earning artists

SELECT Customer.CustomerId,Customer.FirstName,Customer.LastName,SUM(InvoiceLine.UnitPrice*InvoiceLine.Quantity) Amount

FROM Customer

JOIN Invoice

On Customer.CustomerId = Invoice.CustomerId

JOIN InvoiceLine

On Invoice.InvoiceId = InvoiceLine.InvoiceId

JOIN Track

On InvoiceLine.TrackId = Track.TrackId

JOIN Album

On Track.AlbumId = Album.AlbumId

JOIN Artist

On Album.ArtistId = Artist.ArtistId

WHERE Artist.Name = 'Iron Maiden'

GROUP BY Customer.CustomerId

ORDER BY Amount DESC

LIMIT 10
